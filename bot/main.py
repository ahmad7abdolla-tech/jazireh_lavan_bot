from telegram import Update, ReplyKeyboardMarkup
from telegram.ext import ApplicationBuilder, CommandHandler, MessageHandler, ContextTypes, filters
from weather_today import handle_weather_today

# ØªÙˆÚ©Ù† Ø±Ø¨Ø§Øª
BOT_TOKEN = "7586578372:AAGlPQ7tNVs4-FxaHatLH8oZjSpPOSZzCsM"

# Ú©ÛŒØ¨ÙˆØ±Ø¯ Ø§ØµÙ„ÛŒ
main_keyboard = ReplyKeyboardMarkup(
    [["ğŸŒ¦ï¸ Ù‡ÙˆØ§ÛŒ Ù„Ø§ÙˆØ§Ù† Ø§Ù„Ø§Ù† Ú†Ø·ÙˆØ±Ù‡ØŸ"]],
    resize_keyboard=True
)

# Ø¯Ø³ØªÙˆØ± /start
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("Ø³Ù„Ø§Ù…! Ø¨Ù‡ Ø±Ø¨Ø§Øª Ø¬Ø²ÛŒØ±Ù‡ Ù„Ø§ÙˆØ§Ù† Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯ ğŸ‘‹", reply_markup=main_keyboard)

# Ù…Ø¯ÛŒØ±ÛŒØª Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ù…ØªÙ†ÛŒ
async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    text = update.message.text

    if text == "ğŸŒ¦ï¸ Ù‡ÙˆØ§ÛŒ Ù„Ø§ÙˆØ§Ù† Ø§Ù„Ø§Ù† Ú†Ø·ÙˆØ±Ù‡ØŸ":
        await handle_weather_today(update, context)
    else:
        await update.message.reply_text("Ø¯Ø³ØªÙˆØ± Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª. Ù„Ø·ÙØ§Ù‹ ÛŒÚ©ÛŒ Ø§Ø² Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.")

# Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡
def main():
    app = ApplicationBuilder().token(BOT_TOKEN).build()
    app.add_handler(CommandHandler("start", start))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))
    app.run_polling()

if __name__ == "__main__":
    main()
